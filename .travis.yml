language: python
matrix:
  include:
  - os: linux
    sudo: false
    dist: trusty
    python: '2.7'
  - os: linux
    sudo: false
    dist: trusty
    python: '3.4'
  - os: linux
    sudo: false
    dist: trusty
    python: '3.5'
  - os: osx
    language: generic
    env: TRAVIS_PYTHON_VERSION=3.5
before_install:
- wget https://raw.githubusercontent.com/Horta/travis-miniconda/master/install.sh
  -O install.sh
- chmod +x install.sh
- travis_retry bash -x ./install.sh
install:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
before_script:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
- python setup.py test
script:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
- python setup.py sdist
- pip install dist/`ls dist | grep -i -E '\.(gz)$' | head -1`
- pushd /
- python -c "import limix_tool; limix_tool.test()"
- popd
notifications:
  email: false
deploy:
  provider: pypi
  user: danilo.horta
  password:
    secure: Opk3SC+9F2hXd9PJwyJc2jG3oCf2pzWDB5x18Vef5rbwK0vqOUxm9bhKx8cbV/hiYNphuX63fuw7AhGeM18jtws+VFAGj2uRpgHtDsIQ9k8VMdQouDC6jrLyFaT8ujtUCnWsQId1J0jIIH3afrk0cSxZ2lmrb08AFEwTTCyRhFUkYy1RMCPWdbkawuzeG1fOL9gmfum1xHywQLJhVmyizk/dvagnnwv1yQlRdU87pOB97Xq21XqIUcpMXcA0eT5uuqofO5KP1dLZiao/GPnk9AwsEgcD3pIyH7Uu7so/FATIsj1ZKgB13Wf5+lB7xoNk7bwMINzz/jYT7gO1OELyUxSLe7DjmBinAzMtDOMr8p8Y0Z5esHUJzU4vQ7VJGhBQnVtO2s0FyksTmessfTYluVB/wNwp6UB6l/XXBG9ZdKFKRWJ+T7NJEwL57j8pnBmZgG2t52WaZrTX8sdyrMHXxjJyn862w32wQXlDDqFBMANOLtZ02jPmY/2hPj2Qb+n+sSJgaaUb5sW7QWwHmX0OcntBTqXXx/6vhSPN2Uzho5H4ZjAeILzI+gNMi5fJLWGoCc4+yGmiGLnms8buzMwalUQ7VID7ZsxmsnQtOID2juXE0Imjiv6sb5g9MCjSlwBgEdl0v6mtr4UctO5RBl9tTOCgjNiqFrL106Usoj8LzoI=
  on:
    distributions: sdist bdist_wheel
    repo: Horta/limix-tool
