language: python
matrix:
  include:
  - os: linux
    sudo: false
    dist: trusty
    python: '2.7'
  - os: linux
    sudo: false
    dist: trusty
    python: '3.4'
  - os: linux
    sudo: false
    dist: trusty
    python: '3.5'
  - os: osx
    language: generic
    env: TRAVIS_PYTHON_VERSION=3.5
before_install:
- wget https://raw.githubusercontent.com/Horta/travis-miniconda/master/install.sh
  -O install.sh
- chmod +x install.sh
- travis_retry bash -x ./install.sh
install:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
- travis_retry conda install pycparser -y --name travisci
before_script:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
- python setup.py test
script:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
- python setup.py sdist
- pip install dist/`ls dist | grep -i -E '\.(gz)$' | head -1`
- pushd /
- python -c "import limix_tool; limix_tool.test()"
- popd
deploy:
  provider: pypi
  skip_cleanup: true
  user: danilo.horta
  on:
    branch: master
  password:
    secure: CrlIwTwemN7DaKNRcq5JPr4ZB3NUgBsW4RIf+BnVxmcYouphfY9UQaLhnGh8KLZQEG30K9oemcL2+w38nUcbjK2YpA/gKQb1lAGcotyWMNJBcORRf6BTNm3hpux779WcdtOyB4wbGvvijC7WdRhuQzZhh0AiKg+AB7bb6u4TQXC2kFyXmVqtId02TYNWaME/CYaA8q5VfnVeqaLDNSwYo1scolPlSQ1/O6yCwKiwOSxmJIYRKQ3wIeHgtbIamOFSbYkldXKEKc1iWdcMOqKjJch9mMdlMAv2CWdk1QXZgr2QxUjW1ywwv25TLKb2XYOTG7N3He52WQi0krHHqiCj868yin08aQLCpvpP7VG46fIA0f7WgkUwTYfSSpWWiHltjHjipluQaH12eTB/AaMDO5gqK9HjdZxzioEUnsMdWu4xi948Li6YYRzYx18HoX984pnpyFCFdj4LkC15OO9jF7HSHQ4LAxNl27gnqRKXUCJs5+DHz+MDoHtL2JtLDOMYAIgGVIY7KasHSgczEewh7Fx9f15uTGKv/mvx1YytLsuOkWOOb5FwrKXqpJjcXfetfhBh+cr7eFfzV5ML5ufHOw8fHlyjIcX7VHYFjWA9ut8690lEHKEPmfLspplkgOGzXK3GuMvjWq6LFHuaMkJFqkbEeb1PL1Yh7feW7NE2LEg=
notifications:
  email: false
