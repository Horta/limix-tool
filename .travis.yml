language: python
matrix:
  include:
  - os: linux
    sudo: false
    dist: trusty
    python: '2.7'
  - os: linux
    sudo: false
    dist: trusty
    python: '3.4'
  - os: linux
    sudo: false
    dist: trusty
    python: '3.5'
  - os: osx
    language: generic
    env: TRAVIS_PYTHON_VERSION=3.5
before_install:
- wget https://raw.githubusercontent.com/Horta/travis-miniconda/master/install.sh
  -O install.sh
- chmod +x install.sh
- travis_retry bash -x ./install.sh
install:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
before_script:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
- python setup.py test
script:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
- python setup.py sdist
- pip install dist/`ls dist | grep -i -E '\.(gz)$' | head -1`
- pushd /
- python -c "import limix_tool; limix_tool.test()"
- popd
deploy:
  provider: pypi
  skip_cleanup: true
  user: danilo.horta
  on:
    branch: master
  password:
    secure: FGSgYtrWtLt5ArQkg3DvmWke4Ze34w++ApPvuxpRGHI1fw+nxNgIgE8C8yMhELNyYXdyZQxKohs1kKjZqP/n4FML9v4Ttq2gbFJQAlXRKJ9df+k9nyIU/qPHG9fZ/yWqnVvtJ2gNvaZW66j+NtQ3XL+i16v/bAqHwmgW2ULo8iYsH0X6iS6TPaLxUf0CKpirN6xT65BsqqUmAx2hEHStKV1mLRN5I++DJZ/wwqTL6wWaL6TkLdWwZ0lIf/Ce7GSoHjFTOFZoJ/YNb6eRRdSQI2e0UHgPruKkfRfz8xrXH5dAsEjIlR4GFQh1XfI1LZgFvfGtkBVh0hpuM1w+l0mJT/iOAQXKSpo6P9Wb7EpgMIm0FPyEdHqTr15wis9LpqFkwjChGPn/ADxATIG0gzv0LC4kq0rDlMHrc6M64S1PDeFXXv6sqZ2VVq25VIAks0iKu1C7vuQTY0EmUgVWYBfRpRe7dKvXKI4JPtMLd0F3UymUytkKJgWq4blToqukrTnHW5D5E0JVTuOQBVAoNKOR56Io1cbjb3cr04FELxrueoTtcw6tjLo31B3yeXi4qTgBHkXZiGuc6eVxzB2xWotoR1YJ9prc1nNnJvagmSTP3myRO+UxYzsCQ+1PXKko+w3DOPab+vablTKvUYrkkM1oP7PFWZTWwje16YRY07R/9g4=
notifications:
  email: false
